/**
 * sp-pnp-js v0.0.5 - A reusable JavaScript library targeting SharePoint client-side development.
 * Copyright (c) 2016 Microsoft and other contributors
 * MIT
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.$pnp=e()}}(function(){var e;return function t(e,n,o){function r(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return r(n?n:t)},l,l.exports,t,e,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./ProvisioningStep","../ObjectHandlers/ObjectNavigation/ObjectNavigation","../ObjectHandlers/ObjectPropertyBagEntries/ObjectPropertyBagEntries","../ObjectHandlers/ObjectFeatures/ObjectFeatures","../ObjectHandlers/ObjectWebSettings/ObjectWebSettings","../ObjectHandlers/ObjectComposedLook/ObjectComposedLook","../ObjectHandlers/ObjectCustomActions/ObjectCustomActions","../ObjectHandlers/ObjectFiles/ObjectFiles","../ObjectHandlers/ObjectLists/ObjectLists","../../../sharepoint/util","../Resources/Resources","../Provisioning"],r)}(function(e,t){"use strict";var n=e("./ProvisioningStep"),o=e("../ObjectHandlers/ObjectNavigation/ObjectNavigation"),r=e("../ObjectHandlers/ObjectPropertyBagEntries/ObjectPropertyBagEntries"),i=e("../ObjectHandlers/ObjectFeatures/ObjectFeatures"),s=e("../ObjectHandlers/ObjectWebSettings/ObjectWebSettings"),a=e("../ObjectHandlers/ObjectComposedLook/ObjectComposedLook"),c=e("../ObjectHandlers/ObjectCustomActions/ObjectCustomActions"),u=e("../ObjectHandlers/ObjectFiles/ObjectFiles"),l=e("../ObjectHandlers/ObjectLists/ObjectLists"),p=e("../../../sharepoint/util"),f=e("../Resources/Resources"),d=e("../Provisioning"),y=function(){function e(){this.handlers={Navigation:o.ObjectNavigation,PropertyBagEntries:r.ObjectPropertyBagEntries,Features:i.ObjectFeatures,WebSettings:s.ObjectWebSettings,ComposedLook:a.ObjectComposedLook,CustomActions:c.ObjectCustomActions,Files:u.ObjectFiles,Lists:l.ObjectLists}}return e.prototype.applyTemplate=function(e,t){var n=this,o=p.replaceUrlTokens(e);return this.options=t||{},new Promise(function(e,t){jQuery.getJSON(o,function(t){n.start(t,Object.keys(t)).then(e,e)}).fail(function(){d.Log.error("Provisioning",f.Template_invalid)})})},e.prototype.start=function(e,t){var o=this;return d.Log.info("Provisioning",f.Code_execution_started),new Promise(function(r,i){o.startTime=(new Date).getTime(),o.queueItems=[],t.forEach(function(t,r){o.handlers[t]&&o.queueItems.push(new n.ProvisioningStep(t,r,e[t],e.Parameters,o.handlers[t]))});var s=[];s.push(jQuery.Deferred()),s[0].resolve(),s[0].promise();for(var a=1;void 0!==o.queueItems[a-1];){var c=s.length-1;s.push(o.queueItems[a-1].execute(s[c])),a++}Promise.all(s).then(function(){d.Log.info("Provisioning",f.Code_execution_ended)},function(){d.Log.info("Provisioning",f.Code_execution_ended)})})},e}();t.Core=y})},{"../../../sharepoint/util":50,"../ObjectHandlers/ObjectComposedLook/ObjectComposedLook":4,"../ObjectHandlers/ObjectCustomActions/ObjectCustomActions":5,"../ObjectHandlers/ObjectFeatures/ObjectFeatures":6,"../ObjectHandlers/ObjectFiles/ObjectFiles":7,"../ObjectHandlers/ObjectLists/ObjectLists":9,"../ObjectHandlers/ObjectNavigation/ObjectNavigation":10,"../ObjectHandlers/ObjectPropertyBagEntries/ObjectPropertyBagEntries":11,"../ObjectHandlers/ObjectWebSettings/ObjectWebSettings":12,"../Provisioning":13,"../Resources/Resources":14,"./ProvisioningStep":2}],2:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(e,t,n,o,r){this.name=e,this.index=t,this.objects=n,this.parameters=o,this.handler=r}return e.prototype.execute=function(e){var t=this,n=new this.handler;return e?new Promise(function(o,r){e.then(function(){return n.ProvisionObjects(t.objects,t.parameters).then(o,o)})}):n.ProvisionObjects(this.objects,this.parameters)},e}();t.ProvisioningStep=n})},{}],3:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(){this.isLoggerDefined=!1,console&&console.log&&(this.isLoggerDefined=!0),this.spacing="		",this.template="{0} "+this.spacing+" [{1}] "+this.spacing+" [{2}] "+this.spacing+" {3}"}return e.prototype.info=function(e,t){this.print(String.format(this.template,new Date,e,"Information",t))},e.prototype.debug=function(e,t){this.print(String.format(this.template,new Date,e,"Debug",t))},e.prototype.error=function(e,t){this.print(String.format(this.template,new Date,e,"Error",t))},e.prototype.print=function(e){this.isLoggerDefined&&console.log(e)},e}();t.Logger=n})},{}],4:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../../util","../ObjectHandlerBase/ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../../../util"),o=e("../ObjectHandlerBase/ObjectHandlerBase"),i=function(e){function t(){e.call(this,"ComposedLook")}return r(t,e),t.prototype.ProvisionObjects=function(t){var o=this;return e.prototype.scope_started.call(this),new Promise(function(r,i){var s=SP.ClientContext.get_current(),a=s.get_web(),c=t.ColorPaletteUrl?n.replaceUrlTokens(t.ColorPaletteUrl):"",u=t.FontSchemeUrl?n.replaceUrlTokens(t.FontSchemeUrl):"",l=t.BackgroundImageUrl?n.replaceUrlTokens(t.BackgroundImageUrl):null;a.applyTheme(n.getRelativeUrl(c),n.getRelativeUrl(u),l,!0),a.update(),s.executeQueryAsync(function(){e.prototype.scope_ended.call(o),r()},function(){e.prototype.scope_ended.call(o),r()})})},t}(o.ObjectHandlerBase);t.ObjectComposedLook=i})},{"../../../util":39,"../ObjectHandlerBase/ObjectHandlerBase":8}],5:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../ObjectHandlerBase/ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../ObjectHandlerBase/ObjectHandlerBase"),o=function(e){function t(){e.call(this,"CustomActions")}return r(t,e),t.prototype.ProvisionObjects=function(t){var n=this;return e.prototype.scope_started.call(this),new Promise(function(o,r){var i=SP.ClientContext.get_current(),s=i.get_web().get_userCustomActions();i.load(s),i.executeQueryAsync(function(){t.forEach(function(e){var t=jQuery.grep(s.get_data(),function(t){return t.get_title()===e.Title}).length>0;if(!t){var n=s.add();e.Description&&n.set_description(e.Description),e.CommandUIExtension&&n.set_commandUIExtension(e.CommandUIExtension),e.Group&&n.set_group(e.Group),e.Title&&n.set_title(e.Title),e.Url&&n.set_url(e.Url),e.ScriptBlock&&n.set_scriptBlock(e.ScriptBlock),e.ScriptSrc&&n.set_scriptSrc(e.ScriptSrc),e.Location&&n.set_location(e.Location),e.ImageUrl&&n.set_imageUrl(e.ImageUrl),e.Name&&n.set_name(e.Name),e.RegistrationId&&n.set_registrationId(e.RegistrationId),e.RegistrationType&&n.set_registrationType(e.RegistrationType),e.Rights&&n.set_rights(e.Rights),e.Sequence&&n.set_sequence(e.Sequence),n.update()}}),i.executeQueryAsync(function(){e.prototype.scope_ended.call(n),o()},function(){e.prototype.scope_ended.call(n),o()})},function(){e.prototype.scope_ended.call(n),o()})})},t}(n.ObjectHandlerBase);t.ObjectCustomActions=o})},{"../ObjectHandlerBase/ObjectHandlerBase":8}],6:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../ObjectHandlerBase/ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../ObjectHandlerBase/ObjectHandlerBase"),o=function(e){function t(){e.call(this,"Features")}return r(t,e),t.prototype.ProvisionObjects=function(t){var n=this;return e.prototype.scope_started.call(this),new Promise(function(o,r){var i=SP.ClientContext.get_current(),s=i.get_web(),a=s.get_features();t.forEach(function(e){e.Deactivate===!0?a.remove(new SP.Guid(e.ID),!0):a.add(new SP.Guid(e.ID),!0,SP.FeatureDefinitionScope.none)}),s.update(),i.load(a),i.executeQueryAsync(function(){e.prototype.scope_ended.call(n),o()},function(){e.prototype.scope_ended.call(n),o()})})},t}(n.ObjectHandlerBase);t.ObjectFeatures=o})},{"../ObjectHandlerBase/ObjectHandlerBase":8}],7:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../../../sharepoint/util","../ObjectHandlerBase/ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../../../../sharepoint/util"),o=e("../ObjectHandlerBase/ObjectHandlerBase"),i=function(e){function t(){e.call(this,"Files")}return r(t,e),t.prototype.ProvisionObjects=function(t){var o=this;return e.prototype.scope_started.call(this),new Promise(function(r,i){var s=SP.ClientContext.get_current(),a=s.get_web(),c=[],u=[];t.forEach(function(e,t){var r=o.GetFilenameFromFilePath(e.Dest),i=_spPageContextInfo.webServerRelativeUrl,s=a.getFolderByServerRelativeUrl(i+"/"+o.GetFolderFromFilePath(e.Dest));u.push(jQuery.get(n.replaceUrlTokens(e.Src),function(t){var n={};jQuery.extend(n,e,{Filename:r,Folder:s,Contents:t}),c.push(n)}))}),jQuery.when.apply(jQuery,u).done(function(){c.forEach(function(e,t){if(-1===e.Filename.indexOf("Form.aspx")){var n=new SP.FileCreationInformation;n.set_overwrite(void 0!==e.Overwrite?e.Overwrite:!1),n.set_url(e.Filename),n.set_content(new SP.Base64EncodedByteArray);for(var o=0;o<e.Contents.length;o++)n.get_content().append(e.Contents.charCodeAt(o));s.load(e.Folder.get_files().add(n))}}),s.executeQueryAsync(function(){u=[],t.forEach(function(e){e.Properties&&Object.keys(e.Properties).length>0&&u.push(o.ApplyFileProperties(e.Dest,e.Properties)),e.WebParts&&e.WebParts.length>0&&u.push(o.AddWebPartsToWebPartPage(e.Dest,e.Src,e.WebParts,e.RemoveExistingWebParts))}),Promise.all(u).then(function(){o.ModifyHiddenViews(t).then(function(){e.prototype.scope_ended.call(o),r()},function(){e.prototype.scope_ended.call(o),r()})})},function(){e.prototype.scope_ended.call(o),r()})})})},t.prototype.RemoveWebPartsFromFileIfSpecified=function(e,t,n){return new Promise(function(o,r){n||o();var i=t.get_webParts();e.load(i),e.executeQueryAsync(function(){i.get_data().forEach(function(e){e.deleteWebPart()}),e.load(i),e.executeQueryAsync(o,o)},o)})},t.prototype.GetWebPartXml=function(e){return new Promise(function(t,o){var r=[];e.forEach(function(t,o){t.Contents.FileUrl&&r.push(function(){return new Promise(function(r,i){var s=n.replaceUrlTokens(t.Contents.FileUrl);jQuery.get(s,function(t){e[o].Contents.Xml=t,r()}).fail(i)})}())}),Promise.all(r).then(function(){t(e)})})},t.prototype.AddWebPartsToWebPartPage=function(e,t,o,r){var i=this;return new Promise(function(t,s){var a=SP.ClientContext.get_current(),c=a.get_web(),u=_spPageContextInfo.webServerRelativeUrl+"/"+e,l=c.getFileByServerRelativeUrl(u);a.load(l),a.executeQueryAsync(function(){var e=l.getLimitedWebPartManager(SP.WebParts.PersonalizationScope.shared);i.RemoveWebPartsFromFileIfSpecified(a,e,r).then(function(){i.GetWebPartXml(o).then(function(o){o.forEach(function(t){if(t.Contents.Xml){var o=e.importWebPart(n.replaceUrlTokens(t.Contents.Xml)),r=o.get_webPart();e.addWebPart(r,t.Zone,t.Order)}}),a.executeQueryAsync(t,t)})})},t)})},t.prototype.ApplyFileProperties=function(e,t){return new Promise(function(n,o){var r=SP.ClientContext.get_current(),i=r.get_web(),s=_spPageContextInfo.webServerRelativeUrl+"/"+e,a=i.getFileByServerRelativeUrl(s),c=a.get_listItemAllFields();Object.keys(t).forEach(function(e){c.set_item(e,t[e])}),c.update(),r.executeQueryAsync(n,n)})},t.prototype.GetViewFromCollectionByUrl=function(e,t){for(var n=_spPageContextInfo.webServerRelativeUrl+"/"+t,o=e.getEnumerator();o.moveNext();){var r=o.get_current();if(r.get_serverRelativeUrl().toString().toLowerCase()===n.toLowerCase())return r}return null},t.prototype.ModifyHiddenViews=function(e){var t=this;return new Promise(function(n,o){var r=SP.ClientContext.get_current(),i=r.get_web(),s={},a=[],c=[];e.forEach(function(e){e.Views&&e.Views.forEach(function(t){s[t.List]=s[t.List]||[],s[t.List].push(jQuery.extend(t,{Url:e.Dest}))})}),Object.keys(s).forEach(function(e,t){a.push(i.get_lists().getByTitle(e)),c.push(i.get_lists().getByTitle(e).get_views()),r.load(a[t]),r.load(c[t])}),r.executeQueryAsync(function(){Object.keys(s).forEach(function(e,n){var o=s[e],i=a[n],u=c[n];o.forEach(function(e){var n=t.GetViewFromCollectionByUrl(u,e.Url);if(null!=n){if(e.Paged&&n.set_paged(e.Paged),e.Query&&n.set_viewQuery(e.Query),e.RowLimit&&n.set_rowLimit(e.RowLimit),e.ViewFields&&e.ViewFields.length>0){var o=n.get_viewFields();o.removeAll(),e.ViewFields.forEach(function(e){o.add(e)})}n.update()}}),r.load(u),i.update()}),r.executeQueryAsync(n,n)},n)})},t.prototype.GetFolderFromFilePath=function(e){var t=e.split("/");return t.splice(0,t.length-1).join("/")},t.prototype.GetFilenameFromFilePath=function(e){var t=e.split("/");return t[t.length-1]},t}(o.ObjectHandlerBase);t.ObjectFiles=i})},{"../../../../sharepoint/util":50,"../ObjectHandlerBase/ObjectHandlerBase":8}],8:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../Resources/Resources","../../Provisioning"],r)}(function(e,t){"use strict";var n=e("../../Resources/Resources"),o=e("../../Provisioning"),r=function(){function e(e){this.name=e}return e.prototype.ProvisionObjects=function(e,t){return new Promise(function(e,t){e("Not implemented.")})},e.prototype.scope_started=function(){o.Log.info(this.name,n.Code_execution_started)},e.prototype.scope_ended=function(){o.Log.info(this.name,n.Code_execution_ended)},e}();t.ObjectHandlerBase=r})},{"../../Provisioning":13,"../../Resources/Resources":14}],9:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../Sequencer/Sequencer","../ObjectHandlerBase/ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../../Sequencer/Sequencer"),o=e("../ObjectHandlerBase/ObjectHandlerBase"),i=function(e){function t(){e.call(this,"Lists")}return r(t,e),t.prototype.ProvisionObjects=function(t){var o=this;return e.prototype.scope_started.call(this),new Promise(function(r,i){var s=SP.ClientContext.get_current(),a=s.get_web().get_lists(),c=[];s.load(a),s.executeQueryAsync(function(){t.forEach(function(e,t){var n=jQuery.grep(a.get_data(),function(t){return t.get_title()===e.Title})[0];if(n)e.Description&&n.set_description(e.Description),void 0!==e.EnableVersioning&&n.set_enableVersioning(e.EnableVersioning),void 0!==e.EnableMinorVersions&&n.set_enableMinorVersions(e.EnableMinorVersions),void 0!==e.EnableModeration&&n.set_enableModeration(e.EnableModeration),void 0!==e.EnableFolderCreation&&n.set_enableFolderCreation(e.EnableFolderCreation),void 0!==e.EnableAttachments&&n.set_enableAttachments(e.EnableAttachments),void 0!==e.NoCrawl&&n.set_noCrawl(e.NoCrawl),e.DefaultDisplayFormUrl&&n.set_defaultDisplayFormUrl(e.DefaultDisplayFormUrl),e.DefaultEditFormUrl&&n.set_defaultEditFormUrl(e.DefaultEditFormUrl),e.DefaultNewFormUrl&&n.set_defaultNewFormUrl(e.DefaultNewFormUrl),e.DraftVersionVisibility&&n.set_draftVersionVisibility(SP.DraftVisibilityType[e.DraftVersionVisibility]),e.ImageUrl&&n.set_imageUrl(e.ImageUrl),void 0!==e.Hidden&&n.set_hidden(e.Hidden),void 0!==e.ForceCheckout&&n.set_forceCheckout(e.ForceCheckout),n.update(),c.push(n),s.load(c[t]);else{var o=new SP.ListCreationInformation;if(e.Description&&o.set_description(e.Description),void 0!==e.OnQuickLaunch){var r=e.OnQuickLaunch?SP.QuickLaunchOptions.on:SP.QuickLaunchOptions.off;o.set_quickLaunchOption(r)}e.TemplateType&&o.set_templateType(e.TemplateType),e.Title&&o.set_title(e.Title),e.Url&&o.set_url(e.Url);var i=a.add(o);if(void 0!==e.EnableVersioning&&i.set_enableVersioning(e.EnableVersioning),void 0!==e.EnableMinorVersions&&i.set_enableMinorVersions(e.EnableMinorVersions),void 0!==e.EnableModeration&&i.set_enableModeration(e.EnableModeration),void 0!==e.EnableFolderCreation&&i.set_enableFolderCreation(e.EnableFolderCreation),void 0!==e.EnableAttachments&&i.set_enableAttachments(e.EnableAttachments),void 0!==e.NoCrawl&&i.set_noCrawl(e.NoCrawl),e.DefaultDisplayFormUrl&&i.set_defaultDisplayFormUrl(e.DefaultDisplayFormUrl),e.DefaultEditFormUrl&&i.set_defaultEditFormUrl(e.DefaultEditFormUrl),e.DefaultNewFormUrl&&i.set_defaultNewFormUrl(e.DefaultNewFormUrl),e.DraftVersionVisibility){var r=SP.DraftVisibilityType[e.DraftVersionVisibility.toLocaleLowerCase()];i.set_draftVersionVisibility(r)}e.ImageUrl&&i.set_imageUrl(e.ImageUrl),void 0!==e.Hidden&&i.set_hidden(e.Hidden),void 0!==e.ForceCheckout&&i.set_forceCheckout(e.ForceCheckout),c.push(i),s.load(c[t])}}),s.executeQueryAsync(function(){var i=new n.Sequencer([o.ApplyContentTypeBindings,o.ApplyListInstanceFieldRefs,o.ApplyFields,o.ApplyLookupFields,o.ApplyListSecurity,o.CreateViews,o.InsertDataRows,o.CreateFolders],{ClientContext:s,ListInstances:c,Objects:t},o);i.execute().then(function(){e.prototype.scope_ended.call(o),r()})},function(){e.prototype.scope_ended.call(o),r()})},function(){e.prototype.scope_ended.call(o),r()})})},t.prototype.EnsureLocationBasedMetadataDefaultsReceiver=function(e,t){var n=t.get_eventReceivers(),o=new SP.EventReceiverDefinitionCreationInformation;o.set_receiverName("LocationBasedMetadataDefaultsReceiver ItemAdded"),o.set_synchronization(1),o.set_sequenceNumber(1e3),o.set_receiverAssembly("Microsoft.Office.DocumentManagement, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"),o.set_receiverClass("Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver"),o.set_eventType(SP.EventReceiverType.itemAdded),n.add(o),t.update()},t.prototype.CreateFolders=function(e){var t=this;return new Promise(function(n,o){e.ListInstances.forEach(function(n,o){var r=e.Objects[o];if(r.Folders){var i=_spPageContextInfo.webServerRelativeUrl+"/"+r.Url,s=n.get_rootFolder(),a="<MetadataDefaults>",c=!1;if(r.Folders.forEach(function(e){var t=i+"/"+e.Name;if(s.get_folders().add(t),e.DefaultValues){var n=Object.keys(e.DefaultValues).length;n>0&&(a+="<a href='"+t+"'>",Object.keys(e.DefaultValues).forEach(function(t){a+='<DefaultValue FieldName="'+t+'">'+e.DefaultValues[t]+"</DefaultValue>"}),a+="</a>"),c=!0}}),a+="</MetadataDefaults>",c){var u=new SP.FileCreationInformation;u.set_url(i+"/Forms/client_LocationBasedDefaults.html"),u.set_content(new SP.Base64EncodedByteArray),u.set_overwrite(!0);for(var l=0;l<a.length;l++)u.get_content().append(a.charCodeAt(l));s.get_files().add(u),t.EnsureLocationBasedMetadataDefaultsReceiver(e.ClientContext,n)}}}),e.ClientContext.executeQueryAsync(n,n)})},t.prototype.ApplyContentTypeBindings=function(e){return new Promise(function(t,n){var o=e.ClientContext.get_site().get_rootWeb().get_contentTypes(),r=[];e.ListInstances.forEach(function(t,n){r.push(t.get_contentTypes()),e.ClientContext.load(r[n],"Include(Name,Id)"),e.Objects[n].ContentTypeBindings&&(t.set_contentTypesEnabled(!0),t.update())}),e.ClientContext.load(o),e.ClientContext.executeQueryAsync(function(){e.ListInstances.forEach(function(t,n){var i=e.Objects[n];if(i.ContentTypeBindings){var s=r[n],a=new Array;if(i.RemoveExistingContentTypes&&i.ContentTypeBindings.length>0&&s.get_data().forEach(function(e){a.push(e)}),i.ContentTypeBindings.forEach(function(e){s.addExistingContentType(o.getById(e.ContentTypeId))}),i.RemoveExistingContentTypes&&i.ContentTypeBindings.length>0)for(var c=0;c<a.length;c++){var u=a[c];u.deleteObject()}t.update()}}),e.ClientContext.executeQueryAsync(t,t)},t)})},t.prototype.ApplyListInstanceFieldRefs=function(e){return new Promise(function(t,n){var o=e.ClientContext.get_site().get_rootWeb().get_fields();e.ListInstances.forEach(function(t,n){var r=e.Objects[n];r.FieldRefs&&(r.FieldRefs.forEach(function(e){var n=o.getByInternalNameOrTitle(e.Name);t.get_fields().add(n)}),t.update())}),e.ClientContext.executeQueryAsync(t,t)})},t.prototype.ApplyFields=function(e){var t=this;return new Promise(function(n,o){e.ListInstances.forEach(function(n,o){var r=e.Objects[o];r.Fields&&(r.Fields.forEach(function(o){var r=t.GetFieldXml(o,e.ListInstances,n),i=t.GetFieldXmlAttr(r,"Type");"Lookup"!==i&&"LookupMulti"!==i&&n.get_fields().addFieldAsXml(r,!0,SP.AddFieldOptions.addToAllContentTypes)}),n.update())}),e.ClientContext.executeQueryAsync(n,n)})},t.prototype.ApplyLookupFields=function(e){var t=this;return new Promise(function(n,o){e.ListInstances.forEach(function(n,o){var r=e.Objects[o];r.Fields&&(r.Fields.forEach(function(o){var r=t.GetFieldXml(o,e.ListInstances,n);if(r){var i=t.GetFieldXmlAttr(r,"Type");"Lookup"!==i&&"LookupMulti"!==i||n.get_fields().addFieldAsXml(r,!0,SP.AddFieldOptions.addToAllContentTypes)}}),n.update())}),e.ClientContext.executeQueryAsync(n,n)})},t.prototype.GetFieldXmlAttr=function(e,t){return jQuery(jQuery.parseXML(e)).find("Field").attr(t)},t.prototype.GetFieldXml=function(e,t,n){var o="";if(!e.SchemaXml){var r=[];Object.keys(e).forEach(function(n){var o=e[n];if("List"===n){var i=jQuery.grep(t,function(e){return e.get_title()===o});if(!(i.length>0))return null;o="{"+i[0].get_id().toString()+"}",r.push(n+'="'+o+'"')}}),o="<Field "+r.join(" ")+">","Calculated"===e.Type&&(o+="<Formula>"+e.Formula+"</Formula>"),o+="</Field>"}return o},t.prototype.ApplyListSecurity=function(e){return new Promise(function(t,n){e.ListInstances.forEach(function(t,n){var o=e.Objects[n];o.Security&&o.Security.BreakRoleInheritance&&(t.breakRoleInheritance(o.Security.CopyRoleAssignments,o.Security.ClearSubscopes),t.update(),e.ClientContext.load(t.get_roleAssignments()))});var o=e.ClientContext.get_web(),r=o.get_allProperties(),i=o.get_siteGroups(),s=o.get_roleDefinitions();e.ClientContext.load(r),e.ClientContext.load(s),e.ClientContext.executeQueryAsync(function(){e.ListInstances.forEach(function(t,n){var o=e.Objects[n];o.Security&&(o.Security.RoleAssignments.forEach(function(n){var o=null;o="number"==typeof n.RoleDefinition?s.getById(n.RoleDefinition):s.getByName(n.RoleDefinition);var a=SP.RoleDefinitionBindingCollection.newObject(e.ClientContext);a.add(o);var c=null;if(n.Principal.match(/\{[A-Za-z]*\}+/g)){var u=n.Principal.substring(1,n.Principal.length-1),l=r.get_fieldValues()["vti_"+u];c=i.getById(l)}else c=i.getByName(c);t.get_roleAssignments().add(c,a)}),t.update())}),e.ClientContext.executeQueryAsync(t,t)},t)})},t.prototype.CreateViews=function(e){return new Promise(function(t,n){var o=[];e.ListInstances.forEach(function(t,n){o.push(t.get_views()),e.ClientContext.load(o[n])}),e.ClientContext.executeQueryAsync(function(){e.ListInstances.forEach(function(t,n){var r=e.Objects[n];r.Views&&(o.push(t.get_views()),e.ClientContext.load(o[n]),r.Views.forEach(function(i){var s=jQuery.grep(o[n].get_data(),function(e){return r.RemoveExistingViews&&r.Views.length>0?(e.deleteObject(),!1):e.get_title()===i.Title}).length>0;if(s){var a=o[n].getByTitle(i.Title);if(i.Paged&&a.set_paged(i.Paged),i.Query&&a.set_viewQuery(i.Query),i.RowLimit&&a.set_rowLimit(i.RowLimit),i.ViewFields&&i.ViewFields.length>0){var c=a.get_viewFields();c.removeAll(),i.ViewFields.forEach(function(e){c.add(e)})}i.Scope&&a.set_scope(i.Scope),a.update()}else{var u=new SP.ViewCreationInformation;i.Title&&u.set_title(i.Title),i.PersonalView&&u.set_personalView(i.PersonalView),i.Paged&&u.set_paged(i.Paged),i.Query&&u.set_query(i.Query),i.RowLimit&&u.set_rowLimit(i.RowLimit),i.SetAsDefaultView&&u.set_setAsDefaultView(i.SetAsDefaultView),i.ViewFields&&u.set_viewFields(i.ViewFields),i.ViewTypeKind&&u.set_viewTypeKind(SP.ViewType.html);var a=t.get_views().add(u);i.Scope&&(a.set_scope(i.Scope),a.update()),t.update()}e.ClientContext.load(t.get_views())}))}),e.ClientContext.executeQueryAsync(t,t)},t)})},t.prototype.InsertDataRows=function(e){return new Promise(function(t,n){e.ListInstances.forEach(function(t,n){var o=e.Objects[n];o.DataRows&&o.DataRows.forEach(function(n){var o=t.addItem(new SP.ListItemCreationInformation);Object.keys(n).forEach(function(e){o.set_item(e,n[e])}),o.update(),e.ClientContext.load(o)})}),e.ClientContext.executeQueryAsync(t,t)})},t}(o.ObjectHandlerBase);t.ObjectLists=i})},{"../../Sequencer/Sequencer":15,"../ObjectHandlerBase/ObjectHandlerBase":8}],10:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../../util","../ObjectHandlerBase/ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../../../util"),o=e("../ObjectHandlerBase/ObjectHandlerBase"),i=function(e){function t(){e.call(this,"Navigation")}return r(t,e),t.prototype.ProvisionObjects=function(t){var n=this;e.prototype.scope_started.call(this);var o=SP.ClientContext.get_current(),r=o.get_web().get_navigation();return new Promise(function(i,s){n.ConfigureQuickLaunch(t.QuickLaunch,o,r).then(function(){e.prototype.scope_ended.call(n),i()},function(){e.prototype.scope_ended.call(n),i()})})},t.prototype.ConfigureQuickLaunch=function(e,t,o){return new Promise(function(r,i){if(0===e.length)r();else{var s=o.get_quickLaunch();t.load(s),t.executeQueryAsync(function(){for(var i=[],a=s.get_count()-1;a>=0;){var c=s.itemAt(a);i.push(c),c.deleteObject(),a--}t.executeQueryAsync(function(){e.forEach(function(e){var t=n.getNodeFromCollectionByTitle(i,e.Title),o=new SP.NavigationNodeCreationInformation;o.set_title(e.Title),o.set_url(t?t.get_url():n.replaceUrlTokens(e.Url)),o.set_asLastNode(!0),s.add(o)}),t.executeQueryAsync(function(){jQuery.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/web/Navigation/QuickLaunch",type:"get",headers:{accept:"application/json;odata=verbose"}}).done(function(s){s=s.d.results,s.forEach(function(t){var r=o.getNodeById(t.Id),s=r.get_children(),a=jQuery.grep(e,function(e){return e.Title===t.Title})[0];a&&a.Children&&a.Children.forEach(function(e){var t=n.getNodeFromCollectionByTitle(i,e.Title),o=new SP.NavigationNodeCreationInformation;o.set_title(e.Title),o.set_url(t?t.get_url():n.replaceUrlTokens(e.Url)),o.set_asLastNode(!0),s.add(o)})}),t.executeQueryAsync(r,r)})},r)})})}})},t}(o.ObjectHandlerBase);t.ObjectNavigation=i})},{"../../../util":39,"../ObjectHandlerBase/ObjectHandlerBase":8}],11:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../../../sharepoint/util","../ObjectHandlerBase/ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../../../../sharepoint/util"),o=e("../ObjectHandlerBase/ObjectHandlerBase"),i=function(e){function t(){e.call(this,"PropertyBagEntries")}return r(t,e),t.prototype.ProvisionObjects=function(t){var o=this;return e.prototype.scope_started.call(this),new Promise(function(r,i){if(t&&0!==t.length){for(var s=SP.ClientContext.get_current(),a=s.get_web(),c=a.get_allProperties(),u=[],l=0;l<t.length;l++){var p=t[l];c.set_item(p.Key,p.Value),p.Indexed&&u.push(n.encodePropertyKey(p.Key))}a.update(),s.load(c),s.executeQueryAsync(function(){u.length>0?(c.set_item("vti_indexedpropertykeys",u.join("|")),a.update(),s.executeQueryAsync(function(){e.prototype.scope_ended.call(o),r()},function(){e.prototype.scope_ended.call(o),r()})):(e.prototype.scope_ended.call(o),r())},function(){e.prototype.scope_ended.call(o),r()})}else r()})},t}(o.ObjectHandlerBase);t.ObjectPropertyBagEntries=i})},{"../../../../sharepoint/util":50,"../ObjectHandlerBase/ObjectHandlerBase":8}],12:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../ObjectHandlerBase/ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../ObjectHandlerBase/ObjectHandlerBase"),o=function(e){function t(){e.call(this,"WebSettings")}return r(t,e),t.prototype.ProvisionObjects=function(t){var n=this;return e.prototype.scope_started.call(this),new Promise(function(o,r){var i=SP.ClientContext.get_current(),s=i.get_web();t.WelcomePage&&(s.get_rootFolder().set_welcomePage(t.WelcomePage),s.get_rootFolder().update()),t.MasterUrl&&s.set_masterUrl(t.MasterUrl),t.CustomMasterUrl&&s.set_customMasterUrl(t.CustomMasterUrl),void 0!==t.SaveSiteAsTemplateEnabled&&s.set_saveSiteAsTemplateEnabled(t.SaveSiteAsTemplateEnabled),void 0!==t.QuickLaunchEnabled&&s.set_saveSiteAsTemplateEnabled(t.QuickLaunchEnabled),void 0!==t.TreeViewEnabled&&s.set_treeViewEnabled(t.TreeViewEnabled),s.update(),i.load(s),i.executeQueryAsync(function(){e.prototype.scope_ended.call(n),o()},function(){e.prototype.scope_ended.call(n),o()})})},t}(n.ObjectHandlerBase);t.ObjectWebSettings=o})},{"../ObjectHandlerBase/ObjectHandlerBase":8}],13:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Core/Core","./Logger/Logger"],r)}(function(e,t){"use strict";var n=e("./Core/Core"),o=e("./Logger/Logger"),r=function(){function e(){this.core=new n.Core}return e}();t.Provisioning=r,t.Log=new o.Logger})},{"./Core/Core":1,"./Logger/Logger":3}],14:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";t.Code_execution_started="Code execution scope started",t.Code_execution_ended="Code execution scope ended",t.Template_invalid="The provided template is invalid"})},{}],15:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(e,t,n){this.parameter=t,this.scope=n,this.functions=this.deferredArray(e)}return e.prototype.execute=function(){
var e=this;return new Promise(function(t,n){var o=[];o.push(jQuery.Deferred()),o[0].resolve(),o[0].promise();for(var r=1;void 0!==e.functions[r-1];){var i=o.length-1;o.push(e.functions[r-1].execute(o[i])),r++}Promise.all(o).then(t,t)})},e.prototype.deferredArray=function(e){var t=this,n=[];return e.forEach(function(e){return n.push(new o(e,t.parameter,t.scope))}),n},e}();t.Sequencer=n;var o=function(){function e(e,t,n){this.func=e,this.parameter=t,this.scope=n}return e.prototype.execute=function(e){var t=this;return e?new Promise(function(n,o){e.then(function(){t.func.apply(t.scope,[t.parameter]).then(n,n)})}):this.func.apply(this.scope,[this.parameter])},e}()})},{}],16:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../utils/util","../../collections/collections"],r)}(function(e,t){"use strict";var n=e("../../utils/util"),o=e("../../collections/collections"),r=function(){function e(e,t){if(this._query=new o.Dictionary,"string"==typeof e){var r=e;this._url=n.combinePaths(r,t)}else{var i=e;this._url=n.combinePaths(i._url,t),this._query.merge(i._query)}}return e.prototype.concat=function(e){this._url+=e},e.prototype.append=function(e){this._url=n.combinePaths(this._url,e)},Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.toUrl=function(){if(!n.isUrlAbsolute(this._url)&&"undefined"!=typeof _spPageContextInfo){if(_spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return n.combinePaths(_spPageContextInfo.webAbsoluteUrl,this._url);if(_spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return n.combinePaths(_spPageContextInfo.webServerRelativeUrl,this._url)}return this._url},e.prototype.toUrlAndQuery=function(){var e=this,t=this.toUrl();if(this._query.count()>0){t+="?";var n=this._query.getKeys();t+=n.map(function(t,n,o){return t+"="+e._query.get(t)}).join("&")}return t},e}();t.Queryable=r})},{"../../collections/collections":41,"../../utils/util":56}],17:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./site","./webs","../../utils/util"],r)}(function(e,t){"use strict";var n=e("./site"),o=e("./webs"),r=e("../../utils/util"),i=function(){function e(){}return Object.defineProperty(e.prototype,"site",{get:function(){return new n.Site("_api")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return new o.Web("_api")},enumerable:!0,configurable:!0}),e.prototype.crossDomainSite=function(e,t){return this._cdImpl(n.Site,e,t,"site")},e.prototype.crossDomainWeb=function(e,t){return this._cdImpl(o.Web,e,t,"web")},e.prototype._cdImpl=function(e,t,n,o){if(!r.isUrlAbsolute(t))throw"The addInWebUrl parameter must be an absolute url.";if(!r.isUrlAbsolute(n))throw"The hostWebUrl parameter must be an absolute url.";var i=r.combinePaths(t,"_api/SP.AppContextSite(@target)",o),s=new e(i);return s.query.add("@target",encodeURIComponent(n)),s},e}();t.Rest=i})},{"../../utils/util":56,"./site":32,"./webs":36}],18:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./queryable","./mixins","../../utils/util"],r)}(function(e,t){"use strict";var n=e("./queryable"),o=e("./mixins"),i=e("../../utils/util"),s=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.get=function(){},t}(n.Queryable);t.Gettable=s,i.applyMixins(s,o.Gettable);var a=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.get=function(){},t}(n.Queryable);t.SelectableGettable=a,i.applyMixins(a,o.Gettable,o.Selectable);var c=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.filter=function(e){},t.prototype.get=function(){},t}(n.Queryable);t.FilterableGettable=c,i.applyMixins(c,o.Gettable,o.Filterable);var u=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.get=function(){},t.prototype.filter=function(e){},t}(n.Queryable);t.FilterableSelectableGettable=u,i.applyMixins(u,o.Gettable,o.Selectable,o.Filterable)})},{"../../utils/util":56,"./mixins":26,"./queryable":28}],19:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=function(e){function t(t){e.call(this,t,"contentTypes")}return r(t,e),t.prototype.getById=function(e){return this.concat('("'+e+'")'),new a(this)},t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.filter=function(e){},t}(n.Queryable);t.ContentTypes=s,o.applyMixins(s,i.Gettable,i.Selectable,i.Filterable);var a=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.ContentType=a,o.applyMixins(a,i.Gettable,i.Selectable)})},{"../../utils/util":56,"./Queryable":16,"./mixins":26}],20:[function(e,t,n){arguments[4][19][0].apply(n,arguments)},{"../../utils/util":56,"./Queryable":16,"./mixins":26,dup:19}],21:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./queryable","../../utils/util","./mixins"],r)}(function(e,t){"use strict";var n=e("./queryable"),o=e("../../utils/util"),i=e("./mixins"),s=function(e){function t(t){e.call(this,t,"fields")}return r(t,e),t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.filter=function(e){},t}(n.Queryable);t.Fields=s,o.applyMixins(s,i.Gettable,i.Selectable,i.Filterable);var a=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.Field=a,o.applyMixins(a,i.Gettable,i.Selectable)})},{"../../utils/util":56,"./mixins":26,"./queryable":28}],22:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins","./actionables"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=e("./actionables"),a=function(e){function t(t){e.call(this,t,"files")}return r(t,e),t.prototype.getByName=function(e){return this.concat("('"+e+"')"),new c(this)},t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.filter=function(e){},t}(n.Queryable);t.Files=a,o.applyMixins(a,i.Gettable,i.Selectable,i.Filterable);var c=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.append("$value"),new s.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedOutByUser",{get:function(){return this.append("CheckedOutByUser"),new s.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eTag",{get:function(){return this.append("ETag"),new s.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverRelativeUrl",{get:function(){return this.append("ServerRelativeUrl"),new s.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.File=c,o.applyMixins(c,i.Gettable,i.Selectable);var u=function(e){function t(t){e.call(this,t,"versions")}return r(t,e),t.prototype.getById=function(e){return this.concat("("+e+")"),new l(this)},t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.filter=function(e){},t}(n.Queryable);t.Versions=u,o.applyMixins(u,i.Gettable,i.Selectable,i.Filterable);var l=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.Version=l,o.applyMixins(l,i.Gettable,i.Selectable)})},{"../../utils/util":56,"./Queryable":16,"./actionables":18,"./mixins":26}],23:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins","./files","./actionables"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=e("./files"),a=e("./actionables"),c=function(e){function t(t){e.call(this,t,"folders")}return r(t,e),t.prototype.getByName=function(e){return this.concat("('"+e+"')"),new u(this)},t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.filter=function(e){},t}(n.Queryable);t.Folders=c,o.applyMixins(c,i.Gettable,i.Selectable,i.Filterable);var u=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"parentFolder",{get:function(){return new t(this,"ParentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new c(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.append("Name"),new a.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.append("Properties"),new a.SelectableGettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverRelativeUrl",{get:function(){return this.append("ServerRelativeUrl"),new a.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return new s.Files(this)},enumerable:!0,configurable:!0}),t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.Folder=u,o.applyMixins(u,i.Gettable,i.Selectable)})},{"../../utils/util":56,"./Queryable":16,"./actionables":18,"./files":22,"./mixins":26}],24:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins","./actionables","./folders","./contenttypes","./roleassignments"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=e("./actionables"),a=e("./folders"),c=e("./contenttypes"),u=e("./roleassignments"),l=function(e){function t(t){e.call(this,t,"items")}return r(t,e),t.prototype.getById=function(e){return this.concat("("+e+")"),new p(this)},t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.filter=function(e){},t}(n.Queryable);t.Items=l,o.applyMixins(l,i.Gettable,i.Selectable,i.Filterable);var p=function(e){function t(t){e.call(this,t)}return r(t,e),Object.defineProperty(t.prototype,"attachmentFiles",{get:function(){return this.append("AttachmentFiles"),new s.FilterableSelectableGettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return this.append("ContentType"),new c.ContentType(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return this.append("EffectiveBasePermissions"),new s.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissionsForUI",{get:function(){return this.append("EffectiveBasePermissionsForUI"),new s.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsHTML",{get:function(){return this.append("FieldValuesAsHTML"),new s.SelectableGettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsText",{get:function(){return this.append("FieldValuesAsText"),new s.SelectableGettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesForEdit",{get:function(){return this.append("FieldValuesForEdit"),new s.SelectableGettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return this.append("FirstUniqueAncestorSecurableObject"),new s.SelectableGettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folder",{get:function(){return new a.Folder(this,"Folder")},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){return this.append("getUserEffectivePermissions(@user)"),this._query.add("@user","'"+encodeURIComponent(e)+"'"),new s.Gettable(this)},Object.defineProperty(t.prototype,"roleAssignments",{get:function(){return new u.RoleAssignments(this)},enumerable:!0,configurable:!0}),t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.Item=p,o.applyMixins(p,i.Gettable,i.Selectable)})},{"../../utils/util":56,"./Queryable":16,"./actionables":18,"./contenttypes":20,"./folders":23,"./mixins":26,"./roleassignments":31}],25:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./items","./views","./contenttypes","./fields","./queryable","../../utils/util","./mixins","./actionables"],r)}(function(e,t){"use strict";var n=e("./items"),o=e("./views"),i=e("./contenttypes"),s=e("./fields"),a=e("./queryable"),c=e("../../utils/util"),u=e("./mixins"),l=e("./actionables"),p=function(e){function t(t){e.call(this,t,"lists")}return r(t,e),t.prototype.getByTitle=function(e){return new f(this,"getByTitle('"+e+"')")},t.prototype.getById=function(e){return this.concat("(guid'"+e+"')"),new f(this)},t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.filter=function(e){},t}(a.Queryable);t.Lists=p,c.applyMixins(p,u.Gettable,u.Selectable,u.Filterable);var f=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new i.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return new n.Items(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"views",{get:function(){return new o.Views(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new s.Fields(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultView",{get:function(){return this.append("DefaultView"),new l.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return this.append("EffectiveBasePermissions"),new l.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventReceivers",{get:function(){return this.append("EventReceivers"),new l.FilterableSelectableGettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getRelatedFields",{get:function(){return this.append("getRelatedFields"),new l.Gettable(this)},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){return this.append("getUserEffectivePermissions(@user)"),this._query.add("@user","'"+encodeURIComponent(e)+"'"),new l.Gettable(this)},Object.defineProperty(t.prototype,"informationRightsManagementSettings",{get:function(){return this.append("InformationRightsManagementSettings"),new l.Gettable(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return this.append("UserCustomActions"),new l.Gettable(this)},enumerable:!0,configurable:!0}),t.prototype.getView=function(e){return this.append("getView('"+e+"')"),new o.View(this)},t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(a.Queryable);t.List=f,c.applyMixins(f,u.Gettable,u.Selectable)})},{"../../utils/util":56,"./actionables":18,"./contenttypes":20,"./fields":21,"./items":24,"./mixins":26,"./queryable":28,"./views":35}],26:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./queryable","../../net/httpClient"],r)}(function(e,t){"use strict";var n=e("./queryable"),o=e("../../net/httpClient"),i=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this._query.add("$select",e.join(",")),this},t}(n.Queryable);t.Selectable=i;var s=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t}(n.Queryable);t.Filterable=s;var a=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.get=function(e){void 0===e&&(e=function(e){return e.json()});var t=new o.HttpClient;return t.get(this.toUrlAndQuery()).then(function(t){if(200!==t.status)throw"Error making GET request: "+t.statusText;return e(t)}).then(function(e){return e.hasOwnProperty("d")?e.d.hasOwnProperty("results")?e.d.results:e.d:e})},t}(n.Queryable);t.Gettable=a;var c=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},t}(n.Queryable);t.Pageable=c})},{"../../net/httpClient":48,"./queryable":28}],27:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./queryable","./quickLaunch","./topNavigationBar"],r)}(function(e,t){"use strict";var n=e("./queryable"),o=e("./quickLaunch"),i=e("./topNavigationBar"),s=function(e){function t(t){e.call(this,t,"Navigation")}return r(t,e),Object.defineProperty(t.prototype,"quicklaunch",{get:function(){return new o.QuickLaunch(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topNavigationBar",{get:function(){return new i.TopNavigationBar(this)},enumerable:!0,configurable:!0}),t}(n.Queryable);t.Navigation=s})},{"./queryable":28,"./quickLaunch":29,"./topNavigationBar":34}],28:[function(e,t,n){arguments[4][16][0].apply(n,arguments)},{"../../collections/collections":41,"../../utils/util":56,dup:16}],29:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=function(e){function t(t){e.call(this,t,"QuickLaunch")}return r(t,e),t.prototype.get=function(){},t}(n.Queryable);t.QuickLaunch=s,o.applyMixins(s,i.Gettable)})},{"../../utils/util":56,"./Queryable":16,"./mixins":26}],30:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=function(e){function t(t){e.call(this,t,"RoleAssignments")}return r(t,e),t.prototype.get=function(){},t.prototype.filter=function(e){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.RoleAssignments=s,o.applyMixins(s,i.Gettable,i.Filterable,i.Selectable)})},{"../../utils/util":56,"./Queryable":16,"./mixins":26}],31:[function(e,t,n){arguments[4][30][0].apply(n,arguments)},{"../../utils/util":56,"./Queryable":16,"./mixins":26,dup:30}],32:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins","./webs"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=e("./webs"),a=function(e){function t(t){e.call(this,t,"site")}return r(t,e),Object.defineProperty(t.prototype,"rootWeb",{get:function(){return new s.Web(this,"rootweb")},enumerable:!0,configurable:!0}),t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.Site=a,o.applyMixins(a,i.Gettable,i.Selectable)})},{"../../utils/util":56,"./Queryable":16,"./mixins":26,"./webs":36}],33:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=function(e){function t(t){e.call(this,t,"SiteUsers")}return r(t,e),t.prototype.get=function(){},t.prototype.filter=function(e){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.SiteUsers=s,o.applyMixins(s,i.Gettable,i.Filterable,i.Selectable)})},{"../../utils/util":56,"./Queryable":16,"./mixins":26}],34:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=function(e){function t(t){e.call(this,t,"TopNavigationBar")}return r(t,e),t.prototype.get=function(){},t}(n.Queryable);t.TopNavigationBar=s,o.applyMixins(s,i.Gettable)})},{"../../utils/util":56,"./Queryable":16,"./mixins":26}],35:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=function(e){function t(t){e.call(this,t,"views")}return r(t,e),t.prototype.getById=function(e){return this.concat("(guid'"+e+"')"),new a(this)},t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t.prototype.filter=function(e){},t}(n.Queryable);t.Views=s,o.applyMixins(s,i.Gettable,i.Selectable,i.Filterable);var a=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.View=a,o.applyMixins(a,i.Gettable,i.Selectable)})},{"../../utils/util":56,"./Queryable":16,"./mixins":26}],36:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Queryable","../../utils/util","./mixins","./lists","./roleAssignments","./navigation","./siteUsers","./contentTypes","./folders","./files"],r)}(function(e,t){"use strict";var n=e("./Queryable"),o=e("../../utils/util"),i=e("./mixins"),s=e("./lists"),a=e("./roleAssignments"),c=e("./navigation"),u=e("./siteUsers"),l=e("./contentTypes"),p=e("./folders"),f=e("./files"),d=function(e){function t(t,n){void 0===n&&(n="web"),e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new l.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleAssignments",{get:function(){return new a.RoleAssignments(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lists",{get:function(){return new s.Lists(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigation",{get:function(){return new c.Navigation(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUsers",{get:function(){return new u.SiteUsers(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new p.Folders(this)},enumerable:!0,configurable:!0}),t.prototype.getFolderByServerRelativeUrl=function(e){return new p.Folder(this,"getFolderByServerRelativeUrl('"+e+"')")},t.prototype.getFileByServerRelativeUrl=function(e){return new f.File(this,"getFileByServerRelativeUrl('"+e+"')")},t.prototype.get=function(){},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},t}(n.Queryable);t.Web=d,o.applyMixins(d,i.Gettable,i.Selectable)})},{"../../utils/util":56,"./Queryable":16,"./contentTypes":19,"./files":22,"./folders":23,"./lists":25,"./mixins":26,"./navigation":27,"./roleAssignments":30,"./siteUsers":33}],37:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Provisioning/Provisioning","./Rest/Rest","./Util"],r)}(function(e,t){"use strict";var n=e("./Provisioning/Provisioning"),o=e("./Rest/Rest"),r=e("./Util"),i=function(){function e(){this.rest=new o.Rest,this.provisioning=new n.Provisioning,this.util=r}return e}();t.SharePoint=i})},{"./Provisioning/Provisioning":13,"./Rest/Rest":17,"./Util":38}],38:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";function n(){return _spPageContextInfo.hasOwnProperty("pageListId")?_spPageContextInfo.pageListId.substring(1,37):""}function o(e){return e.replace(document.location.protocol+"//"+document.location.hostname,"")}function r(e,t){var n=jQuery.grep(e,function(e){return e.get_title()===t});return n[0]||null}function i(e){return e.replace(/{site}/g,_spPageContextInfo.webAbsoluteUrl).replace(/{sitecollection}/g,_spPageContextInfo.siteAbsoluteUrl)}function s(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n)),t.push(0);var o=window.btoa(String.fromCharCode.apply(null,t));return o}t.getListId=n,t.getRelativeUrl=o,t.getNodeFromCollectionByTitle=r,t.replaceUrlTokens=i,t.encodePropertyKey=s})},{}],39:[function(e,t,n){arguments[4][38][0].apply(n,arguments)},{dup:38}],40:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";function n(e){return jQuery.ajax({url:e,type:"get",headers:{accept:"application/json;odata=verbose"}})}t.get=n})},{}],41:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(){this.keys=[],this.values=[]}return e.prototype.get=function(e){var t=this.keys.indexOf(e);return 0>t?null:this.values[t]},e.prototype.add=function(e,t){var n=this.keys.indexOf(e);n>-1?this.values[n]=t:(this.keys.push(e),this.values.push(t))},e.prototype.merge=function(e){if(console.log("Type of source: "+typeof e),"ITypedHash<T>"==typeof e){var t=e;for(var n in t)t.hasOwnProperty(n)&&this.add(n,e[n])}else for(var o=e,r=o.getKeys(),i=r.length,s=0;i>s;s++)this.add(r[s],o.get(r[s]))},e.prototype.remove=function(e){var t=this.keys.indexOf(e);if(0>t)return null;var n=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),n},e.prototype.getKeys=function(){return this.keys},e.prototype.getValues=function(){return this.values},e.prototype.clear=function(){this.keys=[],this.values=[]},e.prototype.count=function(){return this.keys.length},e}();t.Dictionary=n})},{}],42:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../collections/collections","./providers/providers"],r);
}(function(e,t){"use strict";var n=e("../collections/collections"),o=e("./providers/providers");t.Providers=o;var r=function(){function e(){this._settings=new n.Dictionary}return e.prototype.add=function(e,t){this._settings.add(e,t)},e.prototype.addJSON=function(e,t){this._settings.add(e,JSON.stringify(t))},e.prototype.apply=function(e){this._settings.merge(e)},e.prototype.load=function(e){var t=this;return new Promise(function(n,o){e.getConfiguration().then(function(e){t._settings.merge(e),n()})["catch"](function(e){o(e)})})},e.prototype.get=function(e){return this._settings.get(e)},e.prototype.getJSON=function(e){var t=this.get(e);return"undefined"==typeof t||null===t?t:JSON.parse(t)},e}();t.Settings=r})},{"../collections/collections":41,"./providers/providers":44}],43:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../utils/storage"],r)}(function(e,t){"use strict";var n=e("../../utils/storage"),o=function(){function e(e,t,n){this.wrappedProvider=e,this.store=n?n:this.selectPnPCache(),this.cacheKey="_configcache_"+t}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var e=this;if(!this.store||!this.store.enabled)return this.wrappedProvider.getConfiguration();var t=this.store.get(this.cacheKey);if(t)return new Promise(function(e,n){e(t)});var n=this.wrappedProvider.getConfiguration();return n.then(function(t){e.store.put(e.cacheKey,t)}),n},e.prototype.selectPnPCache=function(){var e=new n.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw new Error("Cannot create a caching configuration provider since cache is not available.")},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o})},{"../../utils/storage":55}],44:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./cachingConfigurationProvider","./spListConfigurationProvider"],r)}(function(e,t){"use strict";var n=e("./cachingConfigurationProvider"),o=e("./spListConfigurationProvider");t.CachingConfigurationProvider=n["default"],t.SPListConfigurationProvider=o["default"]})},{"./cachingConfigurationProvider":43,"./spListConfigurationProvider":45}],45:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./cachingConfigurationProvider","../../Utils/Ajax"],r)}(function(e,t){"use strict";var n=e("./cachingConfigurationProvider"),o=e("../../Utils/Ajax"),r=function(){function e(e,t){void 0===t&&(t="config"),this.webUrl=e,this.listTitle=t}return e.prototype.getWebUrl=function(){return this.webUrl},e.prototype.getListTitle=function(){return this.listTitle},e.prototype.getConfiguration=function(){var e=this;return new Promise(function(t,n){var r=e.webUrl+"/_api/web/lists/getByTitle('"+e.listTitle+"')/items?$select=Title,Value";o.get(r).success(function(e){var n=e.d.hasOwnProperty("results")?e.d.results:e.d,o={};n.forEach(function(e){o[e.Title]=e.Value}),t(o)})})},e.prototype.asCaching=function(){var e="splist_"+this.webUrl+"+"+this.listTitle;return new n["default"](this,e)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r})},{"../../Utils/Ajax":40,"./cachingConfigurationProvider":43}],46:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../collections/collections","../utils/util"],r)}(function(e,t){"use strict";var n=e("../collections/collections"),o=e("../utils/util"),r=function(){function e(){}return e}();t.CachedDigest=r;var i=function(){function e(e,t){void 0===t&&(t=new n.Dictionary),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,n=this._digests.get(e);if(null!==n){var i=new Date;if(i<n.expiration)return Promise.resolve(n.value)}var s=o.combinePaths(e,"/_api/contextinfo");return t._httpClient.fetchRaw(s,{cache:"no-cache",credentials:"same-origin",headers:{Accept:"application/json","Content-type":"application/json;odata=verbose;charset=utf-8"},method:"POST"}).then(function(e){return e.json()}).then(function(n){var o=new r;o.value=n.FormDigestValue;var i=n.FormDigestTimeoutSeconds,s=new Date;return s.setTime(s.getTime()+1e3*i),o.expiration=s,t._digests.add(e,o),o.value})},e.prototype.clear=function(){this._digests.clear()},e}();t.DigestCache=i})},{"../collections/collections":41,"../utils/util":56}],47:[function(t,n,o){(function(r){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(){}return e.prototype.fetch=function(e,t){return r.fetch(e,t)},e}();t.FetchClient=n})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./fetchClient","./digestCache","../utils/util"],r)}(function(e,t){"use strict";var n=e("./fetchClient"),o=e("./digestCache"),r=e("../utils/util"),i=function(){function e(e){void 0===e&&(e=new n.FetchClient),this._impl=e,this._digestCache=new o.DigestCache(this)}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=this,o=r.extend(t,{cache:"no-cache",credentials:"same-origin"},!0),i=new Headers;if("undefined"!=typeof t.headers){var s=new Request("",{headers:t.headers});s.headers.forEach(function(e,t){i.append(t,e)})}if(i.has("Accept")||i.append("Accept","application/json"),i.has("Content-type")||i.append("Content-type","application/json;odata=verbose;charset=utf-8"),o=r.extend(o,{headers:i}),o.method&&"GET"!==o.method.toUpperCase()&&!i.has("X-RequestDigest")){var a=e.indexOf("/_api/");if(0>a)throw new Error("Unable to determine API url");var c=e.substr(0,a);return this._digestCache.getDigest(c).then(function(t){return i.append("X-RequestDigest",t),n.fetchRaw(e,o)})}return n.fetchRaw(e,o)},e.prototype.fetchRaw=function(e,t){return void 0===t&&(t={}),this._impl.fetch(e,t)},e.prototype.get=function(e,t){void 0===t&&(t={});var n=r.extend(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=r.extend(t,{method:"POST"});return this.fetch(e,n)},e}();t.HttpClient=i})},{"../utils/util":56,"./digestCache":46,"./fetchClient":47}],49:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./utils/Util","./SharePoint/SharePoint","./utils/Storage","./configuration/configuration","./utils/logging"],r)}(function(e,t){"use strict";var n=e("./utils/Util"),o=e("./SharePoint/SharePoint"),r=e("./utils/Storage"),i=e("./configuration/configuration"),s=e("./utils/logging"),a=function(){function e(){}return e.util=n,e.sharepoint=new o.SharePoint,e.storage=new r.PnPClientStorage,e.configuration=i,e.logging=new s.Logger,e}();return a})},{"./SharePoint/SharePoint":37,"./configuration/configuration":42,"./utils/Storage":51,"./utils/Util":52,"./utils/logging":54}],50:[function(e,t,n){arguments[4][38][0].apply(n,arguments)},{dup:38}],51:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./Util"],r)}(function(e,t){"use strict";var n=e("./Util"),o=function(){function e(e,t){this.store=e,this.defaultTimeoutMinutes=t,this.defaultTimeoutMinutes=void 0===t?5:t,this.enabled=this.test()}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(null==t)return t;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this["delete"](e),t=null):t=n.value,t},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype["delete"]=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,o){if(!this.enabled)return t();if(!n.isFunction(t))throw"Function expected for parameter 'getter'.";var r=this.get(e);return null==r&&(r=t(),this.put(e,r)),r},e.prototype.test=function(){var e="test";try{return this.store.setItem(e,e),this.store.removeItem(e),!0}catch(t){return!1}},e.prototype.createPersistable=function(e,t){return"undefined"==typeof t&&(t=n.dateAdd(new Date,"minute",this.defaultTimeoutMinutes)),JSON.stringify({expiration:t,value:e})},e}();t.PnPClientStorageWrapper=o;var r=function(){function e(){this.local="undefined"!=typeof localStorage?new o(localStorage):null,this.session="undefined"!=typeof sessionStorage?new o(sessionStorage):null}return e}();t.PnPClientStorage=r})},{"./Util":52}],52:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";function n(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return function(){t.apply(e,n)}}function o(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)");return t.test(location.search)}function r(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))}function i(e){var t=r(e),n=""===t||/false|0/i.test(t);return!n}function s(e,t,n){return t>0?e.substring(0,t)+n+e.substring(t,e.length):n+e}function a(e,t,n){var o=new Date(e.toLocaleString());switch(t.toLowerCase()){case"year":o.setFullYear(o.getFullYear()+n);break;case"quarter":o.setMonth(o.getMonth()+3*n);break;case"month":o.setMonth(o.getMonth()+n);break;case"week":o.setDate(o.getDate()+7*n);break;case"day":o.setDate(o.getDate()+n);break;case"hour":o.setTime(o.getTime()+36e5*n);break;case"minute":o.setTime(o.getTime()+6e4*n);break;case"second":o.setTime(o.getTime()+1e3*n);break;default:o=void 0}return o}function c(e,t){t&&(e+="?"+encodeURIComponent((new Date).getTime().toString()));var n=document.getElementsByTagName("head");if(n.length>1){var o=document.createElement("link");n[0].appendChild(o),o.setAttribute("type","text/css"),o.setAttribute("rel","stylesheet"),o.setAttribute("href",e)}}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];for(var n=[],o=0;o<e.length;o++)"undefined"!=typeof e[o]&&null!==e[o]&&n.push(e[o].replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,""));return n.join("/").replace(/\\/,"/")}function l(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;e>o;o++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function p(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)});return t}function f(e){return"function"==typeof e}function d(e){return"undefined"==typeof e||null===e||""===e}function y(e,t,n){void 0===n&&(n=!1);var o={};for(var r in e)o[r]=e[r];var i=n?function(e,t){return!e.hasOwnProperty(t)}:function(e,t){return!0};for(var r in t)i(o,r)&&(o[r]=t[r]);return o}function b(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(n){e.prototype[n]=t.prototype[n]})})}function h(e){return/^https?:\/\/|^\/\//i.test(e)}t.getCtxCallback=n,t.urlParamExists=o,t.getUrlParamByName=r,t.getUrlParamBoolByName=i,t.stringInsert=s,t.dateAdd=a,t.loadStylesheet=c,t.combinePaths=u,t.getRandomString=l,t.getGUID=p,t.isFunction=f,t.stringIsNullOrEmpty=d,t.extend=y,t.applyMixins=b,t.isUrlAbsolute=h})},{}],53:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./util"],r)}(function(e,t){"use strict";function n(e,t){if(r.stringIsNullOrEmpty(e))throw"Parameter '"+t+"' cannot be null or empty."}function o(e,t){if("undefined"==typeof e||null===e)throw"Parameter '"+t+"' cannot be null."}var r=e("./util");t.stringIsNullOrEmpty=n,t.objectIsNull=o})},{"./util":56}],54:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./args"],r)}(function(e,t){"use strict";var n=e("./args");!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(t.LogLevel||(t.LogLevel={}));var o=t.LogLevel,r=function(){function e(e,t){void 0===e&&(e=o.Warning),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){n.objectIsNull(e,"listener"),this.subscribers.push(e)},e.prototype.count=function(){return this.subscribers.length},e.prototype.write=function(e,t){void 0===t&&(t=o.Verbose),this.log({level:t,message:e})},e.prototype.log=function(e){if(n.objectIsNull(e,"entry"),!(e.level<this.activeLogLevel))for(var t=0;t<this.subscribers.length;t++)this.subscribers[t].log(e)},e.prototype.measure=function(e,t){console.profile(e);try{return t()}finally{console.profileEnd()}},e}();t.Logger=r;var i=function(){function e(){}return e.prototype.log=function(e){var t=this.format(e);switch(e.level){case o.Verbose:case o.Info:console.log(t);break;case o.Warning:console.warn(t);break;case o.Error:console.error(t)}},e.prototype.format=function(e){return"Message: "+e.message+". Data: "+JSON.stringify(e.data)},e}();t.ConsoleListener=i;var s=function(){function e(e){this.azureInsightsInstrumentationKey=e,n.stringIsNullOrEmpty(e,"azureInsightsInstrumentationKey");var t=window.appInsights||function(e){function t(e){r[e]=function(){var t=arguments;r.queue.push(function(){r[e].apply(r,t)})}}var n,o,r={config:e},i=document,s=window,a="script",c=i.createElement(a);for(c.src=e.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",i.getElementsByTagName(a)[0].parentNode.appendChild(c),r.cookie=i.cookie,r.queue=[],n=["Event","Exception","Metric","PageView","Trace"];n.length;)t("track"+n.pop());return t("setAuthenticatedUserContext"),t("clearAuthenticatedUserContext"),e.disableExceptionTracking||(n="onerror",t("_"+n),o=s[n],s[n]=function(e,t,i,s,a){var c=o&&o(e,t,i,s,a);return c!==!0&&r["_"+n](e,t,i,s,a),c}),r}({instrumentationKey:this.azureInsightsInstrumentationKey});window.appInsights=t}return e.prototype.log=function(e){var t=window.appInsights,n=this.format(e);e.level===o.Error?t.trackException(n):t.trackEvent(n)},e.prototype.format=function(e){return"Message: "+e.message+". Data: "+JSON.stringify(e.data)},e}();t.AzureInsightsListener=s;var a=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}();t.FunctionListener=a})},{"./args":53}],55:[function(e,t,n){arguments[4][51][0].apply(n,arguments)},{"./Util":52,dup:51}],56:[function(e,t,n){arguments[4][52][0].apply(n,arguments)},{dup:52}]},{},[49])(49)});
//# sourceMappingURL=pnp.min.js.map
